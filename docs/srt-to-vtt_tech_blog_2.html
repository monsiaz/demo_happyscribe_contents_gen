<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <title>Automating SRT → VTT subtitle conversion in CI/CD - HappyScribe</title>
  <meta name='description' content='AI-generated page about subtitle conversion.'>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <link rel='canonical' href='https://monsiaz.github.io/demo_happyscribe_contents_gen/srt-to-vtt_tech_blog_2.html'>
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css'>
  <link rel='stylesheet' href='settings/web_assets/style.css'>
</head>
<body>
  <header class='topbar'>
     <div class='container topbar-inner'>
        <a class='brand' href='/'><img src='settings/web_assets/header.png' class='hero-img' alt='Header'></a>
     </div>
  </header>

  <main class='container'>
     <nav id='toc' class='toc'></nav>
     {
    "export": {
      "format": "vtt",
      "transcription_ids": ["srt_generated_id"],
      "show_timestamps": false
    }
  }' | jq .
    </code></pre>

    <p>
      The response contains an export id you will use for polling. Integrate this
      call into your build config file as a step that runs when tests pass or
      before a deployment stage.
    </p>

    <h2>What are the authentication best practices?</h2>

    <p>
      Securely handling API keys is critical. Use your secrets management solution
      to inject the <strong>HappyScribe API</strong> key at runtime. Never commit
      the key to version control or expose it in logs. Rotate keys periodically
      and grant least privilege at the account level.
    </p>

    <pre><code>
# Inject secret at pipeline runtime
HAPPYSCRIBE_API_KEY=$(vault kv get -field=key secret/happyscribe)

# Example export call with header
curl -H "Authorization: Bearer $HAPPYSCRIBE_API_KEY" \
     -H "Content-Type: application/json" \
     -d '{"export":{"format":"vtt","transcription_ids":["abc123"]}}' \
     https://www.happyscribe.com/api/v1/exports
    </code></pre>

    <p>
      If you hit rate limits you will receive a 429 response with a retry_in_seconds
      field. Parse it to wait exactly the required time before retrying.
    </p>

    <h2>How do you handle polling and throttling?</h2>

    <p>
      After creating an export you need to wait for it to be ready. Polling too
      aggressively can trigger the rate limit. Implement an exponential backoff
      with jitter to avoid thundering herd issues when scaling pipelines.
    </p>

    <pre><code>
import os
import time
import random
import requests

API_KEY = os.getenv("HAPPYSCRIBE_API_KEY")
EXPORT_ID = "export_id_here"
url = f"https://www.happyscribe.com/api/v1/exports/{EXPORT_ID}"
headers = {"Authorization": f"Bearer {API_KEY}"}

def poll_export():
    delay = 5
    while True:
        resp = requests.get(url, headers=headers).json()
        state = resp.get("state")
        if state == "ready":
            return resp.get("download_link")
        if state == "failed":
            raise Exception("Export failed")
        wait = delay + random.uniform(0, 2)
        time.sleep(wait)
        delay = min(delay * 2, 60)

download_link = poll_export()
print("Download at:", download_link)
    </code></pre>

    <p>
      Use the download link immediately. Signed URLs expire after a short period.
      Do not reuse them in other contexts.
    </p>

    <h2>How do you handle source file upload when you only have an SRT?</h2>

    <p>
      If you already generated an SRT file from transcription you can skip media
      upload. The export endpoint accepts transcription IDs directly. If you need
      to reimport an SRT as a new transcription for alignment or translation,
      use the uploads endpoint.
    </p>

    <pre><code>
# 1. Create a placeholder transcription with existing SRT URL
curl -X POST https://www.happyscribe.com/api/v1/transcriptions \
  -H "Authorization: Bearer $HAPPYSCRIBE_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "transcription": {
      "name": "aligned_subtitle",
      "language": "en-US",
      "tmp_url": "https://cdn.example.com/subtitles/myfile.srt",
      "service": "alignment"
    }
  }
     
  </main>

  <footer>
     <div class='container small text-muted'>© HappyScribe · Generated by <strong>o4-mini-2025-04-16</strong></div>
  </footer>

  <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js'></script>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
     const toc = document.getElementById('toc');
     if (!toc) return;
     const h2s = Array.from(document.querySelectorAll('main.container h2'));
     if (!h2s.length) { toc.remove(); return; }
     const ul = document.createElement('ul');
     h2s.forEach(h => {
        const id = h.textContent.trim().toLowerCase().replace(/[^a-z0-9]+/g,'-');
        h.id = id;
        const li = document.createElement('li');
        li.innerHTML = "<a href='#"+id+"'>"+h.textContent+"</a>";
        ul.appendChild(li);
     });
     toc.innerHTML = '<h2>Table of contents</h2>';
     toc.appendChild(ul);
  });
  </script>
</body>
</html>